{% extends "base.html" %}
{% load form_display %}
{% block title %}New Query{% endblock %}
{% block h1 %}New Query{% endblock %}

{% block headextra %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.46.0/codemirror.min.css" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.46.0/codemirror.min.js" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.46.0/mode/sql/sql.min.js" referrerpolicy="no-referrer"></script>
    <script nonce="{{ CSP_NONCE }}">
        $(function(){
            var editor = CodeMirror.fromTextArea( $("#id_query").get()[0], {'mode':'text/x-sql'});
        });
    </script>
{% endblock %}

{% block subbreadcrumbs %}
<li><a href="{% url "reports:view_reports" %}">Reports</a></li> 
<li><a href="{% url "reports:view_report" report=report.slug %}">{{report.name}}</a></li>
<li>New Query</li>
{% endblock %}

{% block actions %}
{% endblock %}

{% block content %}

<form action="{% url "reports:new_query" report=report.slug %}" method="post">{% csrf_token %}
<fieldset>
{{ form|as_dl }}
<p><input type="submit" class="submit" value="Submit" /></p>
</fieldset>
</form>

{% endblock %}
